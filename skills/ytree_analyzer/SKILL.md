---
name: ytree_analyzer
description: –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ Y-–î–ù–ö –¥–µ—Ä–µ–≤–∞. –ü—Ä–∞–≤–∏–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–æ–ª–æ–∂–µ–Ω–∏–µ –ª—é–±–æ–π –≥–∞–ø–ª–æ–≥—Ä—É–ø–ø—ã –≤ –¥–µ—Ä–µ–≤–µ –∏ –Ω–∞—Ö–æ–¥–∏—Ç —Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–µ –≤–µ—Ç–≤–∏.
---

# Y-Tree Analyzer ‚Äî –ü—Ä–∞–≤–∏–ª–∞ —Ä–∞–±–æ—Ç—ã —Å Y-–¥–µ—Ä–µ–≤–æ–º

## üîë –ì–õ–ê–í–ù–û–ï –ü–†–ê–í–ò–õ–û

**–ù–∏–∫–æ–≥–¥–∞ –Ω–µ –æ–ø—Ä–µ–¥–µ–ª—è–π –≥–∞–ø–ª–æ–≥—Ä—É–ø–ø—É –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é!**

‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û: `if 'L25' in haplo: return 'L25'`
‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: –ü–æ–ª—É—á–∏—Ç—å –ø–æ–ª–Ω—ã–π –ø—É—Ç—å –∏–∑ API –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–ª–æ–∂–µ–Ω–∏–µ –≤ –¥–µ—Ä–µ–≤–µ

---

## üìä –ò–µ—Ä–∞—Ä—Ö–∏—è J-–≥–∞–ø–ª–æ–≥—Ä—É–ø–ø

```
J (J-M304)
‚îú‚îÄ‚îÄ J1 (J-M267)
‚îÇ   ‚îî‚îÄ‚îÄ –í—Å–µ –≤–µ—Ç–≤–∏ J1: P58, Y6096, Y30811, P81, Z1853 –∏ —Ç.–¥.
‚îÇ
‚îî‚îÄ‚îÄ J2 (J-M172)
    ‚îú‚îÄ‚îÄ J2b (J-M12/J-M102)
    ‚îÇ   ‚îî‚îÄ‚îÄ –í–µ—Ç–≤–∏: Y305471, Y21045, Z2453 –∏ –¥—Ä.
    ‚îÇ
    ‚îî‚îÄ‚îÄ J2a (J-M410)
        ‚îú‚îÄ‚îÄ J-L24 ‚Üí J-L25 ‚Üí ... ‚Üí (–º–Ω–æ–∂–µ—Å—Ç–≤–æ –≤–µ—Ç–≤–µ–π)
        ‚îÇ
        ‚îî‚îÄ‚îÄ –í–ê–ñ–ù–û: –ù–µ –≤—Å–µ J2a —Å–æ–¥–µ—Ä–∂–∞—Ç "L25" –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏!
                   –ù–∞–ø—Ä–∏–º–µ—Ä, J-M410 ‚Äî —ç—Ç–æ –ø—Ä–µ–¥–æ–∫ L25, –Ω–æ –Ω–µ –ø–æ—Ç–æ–º–æ–∫.
```

---

## ‚úÖ –ê–ª–≥–æ—Ä–∏—Ç–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–æ–ª–æ–∂–µ–Ω–∏—è

### –®–∞–≥ 1: –û—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å J1

```python
j1_markers = ['M267', 'P58', 'Y6096', 'Y30811', 'P81', 'Z1853', 'ZS2138', 'Y3441']

if any(m in haplo_upper for m in j1_markers):
    return 'J1'  # –≠—Ç–æ J1, –Ω–µ J2
```

### –®–∞–≥ 2: –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å J2a vs J2b

```python
# –ü–æ–ª—É—á–∏—Ç—å –ø–æ–ª–Ω—ã–π –ø—É—Ç—å –∏–∑ API
path = get_haplogroup_path(snp)  # "A0-T > ... > J-M172 > J-M410 > J-L25 > ..."

if 'M12' in path or 'M102' in path:
    return 'J2b'
else:
    return 'J2a'
```

### –®–∞–≥ 3: –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å L25+

```python
# L25+ = –ø–æ—Ç–æ–º–∫–∏ J-L25 (–≤–∫–ª—é—á–∞—è L25 –∏ –≤—Å—ë, —á—Ç–æ –Ω–∏–∂–µ)
# –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ "J-L25 " –≤ –ø—É—Ç–∏ (—Å –ø—Ä–æ–±–µ–ª–æ–º!)

if 'J-L25 ' in path:  # –í–∞–∂–Ω–æ: —Å –ø—Ä–æ–±–µ–ª–æ–º –ø–æ—Å–ª–µ L25!
    return 'L25+'
else:
    return 'L25 ancestor'  # –ü—Ä–µ–¥–æ–∫ L25 (J-M410, J-L26 –∏ —Ç.–¥.)
```

---

## üìå –ü—Ä–∏–º–µ—Ä—ã

### –ü—Ä–∏–º–µ—Ä 1: J-Y94477

**–ó–∞–ø—Ä–æ—Å API:** `GET /api/search/J-Y94477`

**–ü—É—Ç—å:** `A0-T > ... > J-M172 > J-M410 > J-L26 > J-PF5087 > J-PF5160 > J-L24 > J-Y22662 > J-L25 > J-Z438 > J-Z387 > ... > J-Y94477`

**–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:**
- J1? ‚ùå –ù–µ—Ç M267
- J2b? ‚ùå –ù–µ—Ç M12
- L25+? ‚úÖ –î–∞, –µ—Å—Ç—å "J-L25 " –≤ –ø—É—Ç–∏
- **–†–µ–∑—É–ª—å—Ç–∞—Ç: J2a-L25+**

---

### –ü—Ä–∏–º–µ—Ä 2: J-M410

**–ü—É—Ç—å:** `A0-T > ... > J-M172 > J-M410`

**–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:**
- J1? ‚ùå
- J2b? ‚ùå
- L25+? ‚ùå (L25 –Ω–µ—Ç –≤ –ø—É—Ç–∏!)
- **–†–µ–∑—É–ª—å—Ç–∞—Ç: J2a-L25-ancestor (–ø—Ä–µ–¥–æ–∫ L25)**

---

### –ü—Ä–∏–º–µ—Ä 3: J-Y305471

**–ü—É—Ç—å:** `A0-T > ... > J-M172 > J-M12 > J-Y305471`

**–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:**
- J1? ‚ùå
- J2b? ‚úÖ –î–∞, –µ—Å—Ç—å M12
- **–†–µ–∑—É–ª—å—Ç–∞—Ç: J2b**

---

## üîß –§—É–Ω–∫—Ü–∏–∏ –Ω–∞–≤—ã–∫–∞

### 1. –ü–æ–ª—É—á–∏—Ç—å –ø–æ–ª–Ω—ã–π –ø—É—Ç—å

```python
def get_path(snp):
    url = f"https://snp.valalav.ru/api/search/{snp}"
    return requests.get(url).json()['yfullDetails']['path']['string']
```

### 2. –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é

```python
def classify_haplogroup(snp):
    path = get_path(snp)
    
    # J1?
    if any(m in path for m in ['M267', 'P58', 'Y6096']):
        return 'J1'
    
    # J2b?
    if 'M12' in path or 'M102' in path:
        return 'J2b'
    
    # L25+?
    if 'J-L25 ' in path:
        return 'L25+'
    
    # J2a ancestor
    return 'J2a-ancestor'
```

### 3. –ù–∞–π—Ç–∏ —Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–µ –≤–µ—Ç–≤–∏

```python
def find_relatives(snp, max_tmrca=10000):
    """–ù–∞—Ö–æ–¥–∏—Ç –≤—Å–µ –≤–µ—Ç–≤–∏ —Å TMRCA <= max_tmrca"""
    # 1. –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â—É—é –≤–µ—Ç–≤—å –∏ –µ—ë TMRCA
    # 2. –ü–æ–¥–Ω–∏–º–∞–µ–º—Å—è –ø–æ –¥–µ—Ä–µ–≤—É –¥–æ –Ω—É–∂–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è
    # 3. –°–æ–±–∏—Ä–∞–µ–º –≤—Å–µ –æ–±—Ä–∞–∑—Ü—ã –∏–∑ —ç—Ç–∏—Ö –≤–µ—Ç–≤–µ–π
```

---

## üìã –†–∞–±–æ—Ç–∞ —Å AADNA

### –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–∏—Å–∫

```python
# –®–∞–≥ 1: –ë–µ—Ä—ë–º –í–°–ï J
all_j = df[df['Haplogroup'].str.startswith('J')]

# –®–∞–≥ 2: –û—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤—ã–≤–∞–µ–º J1
j1_markers = ['M267', 'P58', 'Y6096', 'Y30811', 'P81', 'Z1853', 'ZS2138']
j2 = all_j[~all_j['Haplogroup'].str.contains('|'.join(j1_markers))]

# –®–∞–≥ 3: –î–ª—è –∫–∞–∂–¥–æ–≥–æ J2 –ø–æ–ª—É—á–∞–µ–º –ø—É—Ç—å –∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—é
for haplo in j2['Haplogroup'].unique():
    category = classify_haplogroup(haplo)
    # –¢–µ–ø–µ—Ä—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∏—Ä–æ–≤–∞–Ω–æ!
```

---

## ‚ùå –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏

### –û—à–∏–±–∫–∞ 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é

```python
# ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û
if 'L25' in haplo:
    return 'L25+'
```

**–ü–æ—á–µ–º—É –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ:** J-M410 —Å–æ–¥–µ—Ä–∂–∏—Ç "M410", –Ω–æ –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç L25. –ê J-Y305471 –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–∏ L25, –Ω–∏ M410, –Ω–æ —ç—Ç–æ J2b.

---

### –û—à–∏–±–∫–∞ 2: –ü—É—Ç–∞–Ω–∏—Ü–∞ J1 –∏ J2

```python
# ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û
if 'J2' in haplo:
    return 'J2'
```

**–ü–æ—á–µ–º—É –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ:** J1 –∏ J2 ‚Äî —Ä–∞–∑–Ω—ã–µ –≥–∞–ø–ª–æ–≥—Ä—É–ø–ø—ã. J1 = J-M267, J2 = J-M172. –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –ø–æ –º–∞—Ä–∫–µ—Ä–∞–º.

---

### –û—à–∏–±–∫–∞ 3: –ù–µ–ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –º–∞—Ä–∫–µ—Ä–æ–≤

```python
# ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û (–ø—Ä–æ–ø—É—Å—Ç–∏–ª–∏ Y6096)
j1_markers = ['M267', 'P58']
```

**–ü–æ—á–µ–º—É –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ:** Y6096 ‚Äî —ç—Ç–æ —Ç–æ–∂–µ J1, –µ–≥–æ –ø—Ä–æ–ø—É—Å—Ç–∏–º.

---

### –û—à–∏–±–∫–∞ 4: –ù–µ —É—á–∏—Ç—ã–≤–∞—Ç—å –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç—å –¥–µ—Ä–µ–≤–∞

```python
# ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û
# –ò—Å–∫–∞—Ç—å —Ç–æ–ª—å–∫–æ "L1264" –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏ - –ø—Ä–æ–ø—É—Å—Ç–∏—Ç –≤–ª–æ–∂–µ–Ω–Ω—ã–µ –≤–µ—Ç–≤–∏
if 'L1264' in haplo:
    return 'L1264+'
```

**–ü–æ—á–µ–º—É –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ:** G-Y32924, G-Y269897 –∏ –º–Ω–æ–≥–∏–µ –¥—Ä—É–≥–∏–µ ‚Äî —ç—Ç–æ **–≤–ª–æ–∂–µ–Ω–Ω—ã–µ –≤–µ—Ç–≤–∏** G-L1264. –û–Ω–∏ –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç "L1264" –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏, –Ω–æ —è–≤–ª—è—é—Ç—Å—è –ø–æ—Ç–æ–º–∫–∞–º–∏ G-L1264.

–ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã G-L1264:
```
G-L1264 (80 —É–∑–ª–æ–≤, 5 —É—Ä–æ–≤–Ω–µ–π –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏)
‚îú‚îÄ‚îÄ G-FGC21495
‚îÇ   ‚îú‚îÄ‚îÄ G-Y30992
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ... (–º–Ω–æ–≥–æ –≤–µ—Ç–≤–µ–π)
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ G-Y513104
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îî‚îÄ‚îÄ G-L1264* (–Ω–µ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ)
    ‚îú‚îÄ‚îÄ G-Y32924 (26 –æ–±—Ä–∞–∑—Ü–æ–≤ –≤ AADNA)
    ‚îú‚îÄ‚îÄ G-Y269897 (9 –æ–±—Ä–∞–∑—Ü–æ–≤)
    ‚îî‚îÄ‚îÄ ... (–º–Ω–æ–≥–æ –≤–µ—Ç–≤–µ–π)
```

**‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û:** –ü–æ–ª—É—á–∏—Ç—å –ø–æ–ª–Ω–æ–µ –¥–µ—Ä–µ–≤–æ —á–µ—Ä–µ–∑ API (—Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ) –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–ª–æ–∂–µ–Ω–∏–µ.

–ü–µ—Ä–µ–¥ –∞–Ω–∞–ª–∏–∑–æ–º –ª—é–±–æ–π –≥–∞–ø–ª–æ–≥—Ä—É–ø–ø—ã:

- [ ] –û—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å J1 (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å M267, P58, Y6096, Y30811, P81, Z1853, ZS2138)
- [ ] –ü–æ–ª—É—á–∏—Ç—å –ø–æ–ª–Ω—ã–π –ø—É—Ç—å –∏–∑ API
- [ ] –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å J2a vs J2b (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å M12)
- [ ] –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å L25+ (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å "J-L25 " –≤ –ø—É—Ç–∏)
- [ ] –ü–æ–ª—É—á–∏—Ç—å TMRCA –¥–ª—è –∫–∞–∂–¥–æ–π –≤–µ—Ç–≤–∏
- [ ] –°–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º

---

## üéØ –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ –≤–ª–æ–∂–µ–Ω–Ω–æ–≥–æ –¥–µ—Ä–µ–≤–∞

```python
def get_full_tree(snp, depth=0, max_depth=10):
    """–†–µ–∫—É—Ä—Å–∏–≤–Ω–æ –ø–æ–ª—É—á–∞–µ—Ç –ø–æ–ª–Ω–æ–µ –¥–µ—Ä–µ–≤–æ —Å–æ –≤—Å–µ–º–∏ —É—Ä–æ–≤–Ω—è–º–∏ –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏"""
    if depth > max_depth:
        return []
    
    url = f"https://snp.valalav.ru/api/search/{snp}"
    resp = requests.get(url, timeout=30)
    data = resp.json()
    
    children = data.get('yfullDetails', {}).get('children', [])
    stats = data.get('yfullDetails', {}).get('statistics', {})
    
    # –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ–∫—É—â–∏–π —É–∑–µ–ª
    result = [(snp, stats.get('tmrca'), depth)]
    
    # –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ –¥–æ–±–∞–≤–ª—è–µ–º –¥–µ—Ç–µ–π
    for child in children:
        child_name = child.get('name')
        result.extend(get_full_tree(child_name, depth+1, max_depth))
    
    return result

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
tree = get_full_tree('G-L1264', max_depth=5)
print(f"–í—Å–µ–≥–æ —É–∑–ª–æ–≤: {len(tree)}")
```

---

## üéØ –ë—ã—Å—Ç—Ä—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü–æ–ª—É—á–∏—Ç—å –ø—É—Ç—å –¥–ª—è SNP
curl -s "https://snp.valalav.ru/api/search/J-Y94477" | jq '.yfullDetails.path.string'

# –ü–æ–ª—É—á–∏—Ç—å TMRCA
curl -s "https://snp.valalav.ru/api/search/J-Y94477" | jq '.yfullDetails.statistics.tmrca'

# –ü–æ–ª—É—á–∏—Ç—å –¥–æ—á–µ—Ä–Ω–∏–µ –≤–µ—Ç–≤–∏
curl -s "https://snp.valalav.ru/api/search/J-Y94477" | jq '.yfullDetails.children[].name'
```

---

*–û–±–Ω–æ–≤–ª–µ–Ω–æ: 2026-02-23*
